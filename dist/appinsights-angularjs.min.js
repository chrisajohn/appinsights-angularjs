/*! appinsights-angularjs version 0.1.0 2016-10-04 */
var Tools=function(){function a(b){a.isDefined=b.isDefined,a.isUndefined=b.isUndefined,a.isObject=b.isObject,a.isArray=b.isArray,a.isString=b.isString,a.extend=b.extend,a.toJson=b.toJson,a.fromJson=b.fromJson,a.forEach=b.forEach,a.noop=b.noop}return a.isNullOrUndefined=function(b){return a.isUndefined(b)||null===b},a.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},a.generateGuid=function(){for(var a=[],b="0123456789abcdef",c=0;36>c;c++)a[c]=b.substr(Math.floor(16*Math.random()),1);return a[8]=a[13]=a[18]=a[23]="-",a[14]="4",a[19]=b.substr(3&a[19]|8,1),a.join("")},a}(),LogInterceptor=function(){function a(b,c){var d=this;this._angular=c,this._noop=this._angular.noop,a.interceptFuntion=this._noop,b.decorator("$log",["$delegate",function(a){return d._debugFn=a.debug,d._infoFn=a.info,d._warnFn=a.warn,d._errorFn=a.error,d._logFn=a.log,a.debug=c.extend(d.delegator(d._debugFn,"debug"),d._debugFn),a.info=c.extend(d.delegator(d._infoFn,"info"),d._infoFn),a.warn=c.extend(d.delegator(d._warnFn,"warn"),d._warnFn),a.error=c.extend(d.delegator(d._errorFn,"error"),d._errorFn),a.log=c.extend(d.delegator(d._logFn,"log"),d._logFn),a}])}return a.prototype.setInterceptFunction=function(b){a.interceptFuntion=b},a.prototype.getPrivateLoggingObject=function(){return{debug:Tools.isNullOrUndefined(this._debugFn)?Tools.noop:this._debugFn,info:Tools.isNullOrUndefined(this._infoFn)?Tools.noop:this._infoFn,warn:Tools.isNullOrUndefined(this._warnFn)?Tools.noop:this._warnFn,error:Tools.isNullOrUndefined(this._errorFn)?Tools.noop:this._errorFn,log:Tools.isNullOrUndefined(this._logFn)?Tools.noop:this._logFn}},a.prototype.delegator=function(b,c){var d=function(){var d=[].slice.call(arguments);a.interceptFuntion(d[0],c),b.apply(null,d)};for(var e in b)d[e]=b[e];return d},a}(),ExceptionInterceptor=function(){function a(b){var c=this;a.errorOnHttpCall=!1,this._interceptFunction=Tools.noop,b.decorator("$exceptionHandler",["$delegate",function(b){return c._origExceptionHandler=b,function(b,d){a.errorOnHttpCall||c._interceptFunction(b,d),c._origExceptionHandler(b,d)}}])}return a.prototype.setInterceptFunction=function(a){this._interceptFunction=a},a.prototype.getPrivateExceptionHanlder=function(){return Tools.isNullOrUndefined(this._origExceptionHandler)?Tools.noop:this._origExceptionHandler},a}(),Options=function(){function a(){this.applicationName="",this.autoPageViewTracking=!0,this.autoLogTracking=!0,this.autoExceptionTracking=!0,this.sessionInactivityTimeout=18e5,this.instrumentationKey="",this.developerMode=!1}return a}(),HttpRequest=function(){function a(){}return a.prototype.send=function(a,b,c){var d=new XMLHttpRequest;d.onerror=function(){c(0)},d.onload=function(){200==d.status?b():c(d.status)},d.open(a.method,a.url,!0);for(var e in a.headers)d.setRequestHeader(e,a.headers[e]);d.send(JSON.stringify(a.data))},a}(),HttpRequestOptions=function(){function a(){}return a}(),ApplicationInsights=function(){function a(a,b,c,d,e){var f=this;this._location=a,this._httpRequestFactory=d,this.options=e,this._log=b.getPrivateLoggingObject(),this._exceptionHandler=c.getPrivateExceptionHanlder(),this._logInterceptor=b,this._exceptionInterceptor=c;var g={config:{instrumentationKey:this.options.instrumentationKey}},h=new Microsoft.ApplicationInsights.Initialization(g);this.appInsights=h.loadAppInsights(),this.options.autoLogTracking&&this._logInterceptor.setInterceptFunction(function(a,b,c){return f.trackTraceMessage(a,b,c)}),this.options.autoExceptionTracking&&this._exceptionInterceptor.setInterceptFunction(function(a,b){return f.trackException(a,b)})}return a.prototype.trackTraceMessage=function(a,b,c){!Tools.isNullOrUndefined(a)&&Tools.isString(a)&&this.appInsights.trackTrace(a,c)},a.prototype.trackException=function(a){Tools.isNullOrUndefined(a)||(this.appInsights.trackException(a,"Unhandled"),this.appInsights.stopTrackPage(this._location.path(),this._location.url()),this.appInsights.context.operation=this.previousOperation)},a}(),httpRequestService=angular.module("$$ApplicationInsights-HttpRequestModule",[]);httpRequestService.factory("$$applicationInsightsHttpRequestService",function(){return function(){return new HttpRequest}});var angularAppInsights=angular.module("ApplicationInsightsModule",["$$ApplicationInsights-HttpRequestModule"]),logInterceptor,exceptionInterceptor,tools=new Tools(angular);angularAppInsights.config(["$provide","$httpProvider",function(a){logInterceptor=new LogInterceptor(a,angular),exceptionInterceptor=new ExceptionInterceptor(a)}]),angularAppInsights.provider("applicationInsightsService",function(){return new AppInsightsProvider}),angularAppInsights.run(["$rootScope","$location","applicationInsightsService",function(a,b,c){a.$on("$stateChangeSuccess",function(){if(c.options.autoPageViewTracking){var a=new Microsoft.ApplicationInsights.Context.Operation;a.name=b.path(),c.previousOperation=c.appInsights.context.operation,c.appInsights.context.operation=a,c.appInsights.startTrackPage(b.path())}}),a.$on("$locationChangeSuccess",function(){c.options.autoPageViewTracking&&c.appInsights.stopTrackPage(b.path(),b.url())}),a.$on("$routeChangeError",function(){c.appInsights.stopTrackPage(b.path(),b.url()),c.appInsights.context.operation=c.previousOperation})}]);var AppInsightsProvider=function(){function a(){var a=this;this._options=new Options,this.$get=["$location","$$applicationInsightsHttpRequestService",function(b,c){return new ApplicationInsights(b,logInterceptor,exceptionInterceptor,c,a._options)}]}return a.prototype.configure=function(a,b,c,d){Tools.isString(b)?(this._options.instrumentationKey=a,this._options.developerMode=d,this._options.applicationName=b,this._options.autoPageViewTracking=Tools.isNullOrUndefined(c)?!0:c):(Tools.extend(this._options,b),this._options.instrumentationKey=a)},a}();